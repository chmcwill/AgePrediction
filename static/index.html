<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    >
    <link rel="stylesheet" href="css/main.css">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    >
    <title>Input Image Page</title>
  </head>
  <body data-api-base="">
    <script>
      window.AGE_PREDICT_API_BASE = "https://w9f5ed90w8.execute-api.us-east-2.amazonaws.com/Prod";
    </script>

    <h1 class="title">Age Predictor: How Old Do You Appear?</h1>

    <div class="outer">
      <div class="inner">
        <form action="#" method="post" enctype="multipart/form-data" id="uploadForm">
          <h3 class="center_p">Input an Image:</h3>
          <p>Images with one or more front facing faces in them will work.</p>
          <p><input type="file" name="file" id="fileInput" accept="image/*"></p>
          <p id="statusMessage" style="color:#222; font-weight:bold"></p>
          <p>
            <input type="submit" name="submit" id="submitBtn"/>
            <span id="loadingSpinner" style="display:none; margin-left:10px;">
              <i class="fa fa-spinner fa-spin fa-2x"></i>
              <span>Processing...</span>
            </span>
          </p>
        </form>
      </div>
    </div>

    <div id="resultsSection" style="display:none;">
      <h2 class="title">Results</h2>
      <div id="resultImages"></div>
    </div>

    <h3 class="title">How does this work?</h3>
    <p class="left_p">
      I have trained a Convolutional Neural Network (CNN) on a cleaned version
      of the IMDB-WIKI face dataset consisting of over 300,000 face age pairs.
      Data preprocessing first extracts the face from the image with 20% margin using a Multi Task
      CNN. The face is further rotated so that the eyes are horizontal to
      enhance stability.
    </p>

    <p class="left_p">
      The model building process involved significant data preparation.
      About 1/3 of the images in the dataset were not helpful to train on
      due to errors such as:
    </p>
    <ul class="left_p">
      <li>Images with no face in them</li>
      <li>Images with too small a face to be meaningful (less than 30 pixels)</li>
      <li>Images with a birth date after the picture was taken (negative age)</li>
      <li>Images where there are multiple faces, causing uncertainty as to who the age is for</li>
      <li>Images where the face is not fully visible (side profile)</li>
      <li>Images where the individual is clearly not the labeled age</li>
    </ul>

    <p class="left_p">
      Images with the first 5 errors were removed before training an initial CNN.
      The CNN was trained using a weighted sampler for equal representation of age.
      Only ages 10 through 70 were used in training due to sparsity in the very young or old ages.
      The initial CNN was then used to filter out the incorrectly labeled images
      where the predicted age was off by more than 20 years. All of these data cleaning
      steps increased performance of the final CNN on an independent and manually
      cleaned test set.
    </p>

    <p class="left_p">
      A classification style approach to the regression problem is used for stability
      and interpretability. The expectation of the resulting probability
      distribution is taken for the prediction.
    </p>

    <p class="left_p">
      The final result is an Age Prediction system that usually predicts
      within 5 years of the true age. This is near human level performance for the task.
      Higher resolution images usually perform better.
    </p>

    <div style="text-align: center">
      <h4 style="margin-right:.69cm; display:inline-block">Cameron McWilliams</h4>
      <a href="https://www.linkedin.com/in/cameron-mcwilliams-7aa036114/" style="color:black">
        <i class="fa fa-linkedin fa-2x top2"></i>
      </a>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/heic2any/dist/heic2any.min.js"></script>
    <script src="js/upload.js"></script>
  </body>
</html>
